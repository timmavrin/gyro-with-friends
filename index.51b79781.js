!function(){let e=(e,t)=>{let n=document.createElement(e);return Object.assign(n,t),n},t=new RTCPeerConnection({iceServers:[]}),n=t.createDataChannel("dc");t.addEventListener("connectionstatechange",t=>{console.log("Connection State Change: ",t),document.querySelector("#peer-container")?.append(e("p",{className:"peer",innerText:t.target.connectionState}))}),t.addEventListener("signalingstatechange",e=>{console.log("Signal State Change: ",e)}),t.addEventListener("negotiationneeded",e=>{console.log("Negotiation Needed: ",e)}),n.addEventListener("open",t=>{console.log("Host Opened",t),document.querySelector("#peer-container")?.append(e("p",{innerText:"peer",className:"peer"}))}),n.addEventListener("message",e=>{console.log("Data channel message",e)});let o=new RTCPeerConnection({iceServers:[]});o.createDataChannel("dc").addEventListener("open",e=>{console.log("Join Opened",e)}),o.addEventListener("connectionstatechange",t=>{console.log("Connection State Change: ",t),document.querySelector("#peer-container")?.append(e("p",{className:"peer",innerText:t.target.connectionState}))});let a=()=>{let t=e("div",{id:"lobby-page"}),n=e("h1",{innerText:"Lobby",className:"lobby-header"}),o=e("input",{type:"text",placeholder:"What's the room password?",id:"room-password"}),a=e("button",{className:"big-button",innerText:"Host",id:"host",onclick:c}),r=e("h1",{innerText:"or",className:"or-separator"}),i=e("button",{className:"big-button",innerText:"Join",id:"join",onclick:s});t.append(n,o,a,r,i),document.body.appendChild(t)},r=()=>{let t=document.querySelector("#lobby-page");t?.append(e("h3",{innerText:"Waiting...",className:"status-message"})),document.querySelector("#host")?.remove(),document.querySelector(".or-separator")?.remove(),document.querySelector("#join")?.remove(),t?.append(e("div",{id:"peer-container"}))},i=()=>{let e=document.querySelector("#room-password");if(!e.value)return e.style.border="1px solid red",setTimeout(()=>e.style.border="revert",1e3),[];let t="https://demo.httprelay.io/link/";return[t+`$master$${e.value}`,t+`$slave$${e.value}`]},c=async()=>{r();let[n,o]=i();if(!n||!o)return;let a=e("p",{innerText:"Connecting",className:"peer",id:"#connection"});document.querySelector("#peer-container")?.append(a);let c=await t.createOffer();await t.setLocalDescription(c),fetch(n,{method:"POST",body:JSON.stringify(c)}).then(()=>{fetch(o).then(e=>e.json()).then(async e=>{await t.setRemoteDescription(new RTCSessionDescription(e))})})},s=()=>{r();let[t,n]=i();if(!t||!n)return;let a=e("p",{innerText:"Connecting",className:"peer",id:"#connection"});document.querySelector("#peer-container")?.append(a),fetch(t).then(e=>e.json()).then(async e=>{await o.setRemoteDescription(new RTCSessionDescription(e));let t=await o.createAnswer();await o.setLocalDescription(t),await fetch(n,{method:"POST",body:JSON.stringify(t)})})};window.onload=()=>{a()}}();
//# sourceMappingURL=index.51b79781.js.map
